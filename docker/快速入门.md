# docker å¿«é€Ÿå…¥é—¨æŒ‡å—



## 1 dockeræ˜¯ä»€ä¹ˆ

`Docker` æ˜¯ä¸€ä¸ªåº”ç”¨æ‰“åŒ…ã€åˆ†å‘ã€éƒ¨ç½²çš„å·¥å…·
ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªè½»é‡çš„è™šæ‹Ÿæœºï¼Œå®ƒåªè™šæ‹Ÿä½ è½¯ä»¶éœ€è¦çš„è¿è¡Œç¯å¢ƒï¼Œå¤šä½™çš„ä¸€ç‚¹éƒ½ä¸è¦ï¼Œ
è€Œæ™®é€šè™šæ‹Ÿæœºåˆ™æ˜¯ä¸€ä¸ªå®Œæ•´è€Œåºå¤§çš„ç³»ç»Ÿï¼ŒåŒ…å«å„ç§ä¸ç®¡ä½ è¦ä¸è¦çš„è½¯ä»¶ã€‚
ï¼ˆå…·ä½“å¯å‚è€ƒ [**ç»™å‰ç«¯çš„docker 10åˆ†é’ŸçœŸ Â· å¿«é€Ÿå…¥é—¨æŒ‡å—**][https://juejin.cn/post/7050304120082661407] ï¼Œè¿™ç¯‡æ–‡ç« å†™çš„æ¯”è¾ƒå¥½ï¼‰



## 2. docker åŸºç¡€

`docker` åˆ†å‡ ä¸ªæ¦‚å¿µï¼š**é•œåƒ**ã€**å®¹å™¨**ã€**ä»“åº“**

**é•œåƒ**ï¼šå°±æ˜¯åƒæ˜¯æˆ‘ä»¬è£…æœºæ—¶å€™éœ€è¦çš„ç³»ç»Ÿç›˜æˆ–è€…ç³»ç»Ÿé•œåƒæ–‡ä»¶ï¼Œè¿™é‡Œå®ƒè´Ÿè´£åˆ›å»º`docker`å®¹å™¨çš„ï¼Œæœ‰å¾ˆå¤šå®˜æ–¹ç°æˆçš„é•œåƒï¼š`node`ã€`mysql`ã€`monogo`ã€`nginx`å¯ä»¥ä»è¿œç¨‹ä»“åº“ä¸‹è½½

**å®¹å™¨**ï¼šå¯ä»¥æ¯”æ‹Ÿæˆä¸€ä¸ªè¿·ä½ çš„ç³»ç»Ÿï¼Œä¾‹å¦‚ä¸€ä¸ªåªå®‰è£…`mysql5.7`çš„`linux`æœ€å°ç³»ç»Ÿï¼Œå½“ç„¶ä½ å–œæ¬¢ä¹Ÿå¯ä»¥æŠŠ`mysql`ã€`node`å®‰è£…åœ¨åŒä¸€ä¸ªå®¹å™¨ä¸­ï¼Œè®°ä½**ï¼Œå®¹å™¨ä¸å®¹å™¨ï¼Œå®¹å™¨å’Œä¸»æœºéƒ½æ˜¯äº’ç›¸éš”ç¦»çš„**

**ä»“åº“**ï¼šä»“åº“å°±åƒæ˜¯`github`é‚£æ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œé•œåƒç„¶å `push` æäº¤åˆ°äº‘ç«¯çš„ä»“åº“ï¼Œä¹Ÿå¯ä»¥ä»ä»“åº“ `pull` ä¸‹è½½é•œåƒ



## 3. dockerå®‰è£…

dockerçš„å®‰è£…å¾ˆç®€å•ï¼Œwinã€osxéƒ½æ˜¯å›¾å½¢ç•Œé¢å®‰è£…ï¼Œlinuxçš„ä¹Ÿå‡ è¡Œå‘½ä»¤,ç°åœ¨çš„macçš„m1èŠ¯ç‰‡ç³»åˆ—ä¹Ÿæ”¯æŒäº†ï¼Œ[**dockerå®˜ç½‘**][https://www.docker.com]

å®‰è£…å¥½è¿è¡Œä¸‹æ–¹ä»£ç æŸ¥çœ‹

```shell
docker -v
```





## 4 å®æˆ˜ï¼šéƒ¨ç½²vue2å’Œvue3é¡¹ç›®

æˆ‘ä»¬è¦è®©ç”µè„‘åŒæ—¶è¿è¡Œ`nodejs12`å’Œ`nodejs14`å¤šä¸ªç‰ˆæœ¬

ç°åœ¨æ–°å»ºä¸€ä¸ªæ–‡ä»¶æ”¾æˆ‘ä»¬çš„é¡¹ç›®ï¼šå‘½å ä¸º : **docker-study**

+ 1. **å®‰è£…vue2+webpacké¡¹ç›®**

     ```shell
     # 1.ç°åœ¨å®‰è£…vue-cli
     npm install -g @vue/cli
     
     # 2.æŸ¥çœ‹vue-cliå®‰è£…æˆåŠŸå¦
     vue --version
     #æˆ‘è¿™é‡Œæ˜¯@vue/cli 5.0.1
     
     # 3. ç”¨vue-cliå¿«é€Ÿåˆ›å»ºé¡¹ç›®,å®‰è£…é€‰é¡¹æˆ‘ä»¬å¦‚ä¸‹
     # > â¯ Default ([Vue 2] babel, eslint) 
     # > â¯ npmåŒ…ç®¡ç†
     vue create my-app-vue2
     ```

+ 2. **å®‰è£…vue3+viteé¡¹ç›®**

     ```shell
     # å…ˆå®‰è£…viteæœ€æ–°ç‰ˆ
     npm init vite@latest
     
     # åˆ›å»ºvue3é¡¹ç›®
     npm init vite@latest my-app-vue3 --template vue
     
     // ä¿®æ”¹vue3é¡¹ç›®ä¸­çš„vite.config.js
     // viteéœ€è¦å¼€å¯ç½‘ç»œè®¿é—®
     // vite.config.js å¼€å¯host
     export default defineConfig({
       plugins: [vue()],
     +  server: {
     +    host: '0.0.0.0',
     +  },
     });
     
     
     ```

+ 3. ### åˆ›å»ºè¿è¡Œdockerå®¹å™¨

     ```shell
     # 1 æ‰§è¡Œpwdå¯ä»¥è·å–å½“å‰æ–‡ä»¶å¤¹åœ¨ç”µè„‘çš„ç»å¯¹ç›®å½•
     pwd
     # /Users/lee/code/2022/docker-study
     
     # 2 è¿è¡Œåˆ›å»ºdockerå®¹å™¨1ï¼šæ‰¿è½½ vue2+webpack+nodejs10
     docker run -it -d --name myvue2 --privileged -p 8081:8080 -v  /Users/lee/code/2022/docker-study/my-app-vue2:/app/vue node:14.17.6 /bin/bash -c "cd /app/vue && node -v && npm install && npm run serve"
     
     # 3 è¿è¡Œåˆ›å»ºdockerå®¹å™¨2ï¼šæ‰¿è½½ vue3+vite+nodejs12
     docker run -it -d --name myvue3 --privileged -p 8080:3000 -v /Users/lee/code/2022/docker-study/my-app-vue3:/app/vue node:12.22.6 /bin/bash -c "cd /app/vue && node -v && npm install && npm run dev"
     
     #è¿è¡ŒæˆåŠŸå æŸ¥çœ‹å®¹å™¨è¿è¡Œæƒ…å†µ
     docker ps -a
     
     ```

     æˆåŠŸè¿è¡Œåä¼šå‡ºç°

     ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h3fozchox5j20nr027q39.jpg)

     æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®¹å™¨çš„å¯åŠ¨çŠ¶æ€ã€ç«¯å£æ˜ å°„ã€å®¹å™¨åå­—

     
     | é”® |  å€¼  |
     | ----  |  ----  |
     | **CONTAINER ID** | å®¹å™¨ ID |
     | **IMAGE** | ä½¿ç”¨çš„é•œåƒ |
     | **COMMAND** | å¯åŠ¨å®¹å™¨æ—¶è¿è¡Œçš„å‘½ä»¤ |
     | **CREATED** | å®¹å™¨çš„åˆ›å»ºæ—¶é—´ |
     | **STATUS** | å®¹å™¨çŠ¶æ€ï¼ˆcreated, restarting, running, removing, paused, exited, deadï¼‰ |
     | **PORTS** | å®¹å™¨çš„ç«¯å£ä¿¡æ¯å’Œä½¿ç”¨çš„è¿æ¥ç±»å‹ï¼ˆtcp\udpï¼‰ |
     | **NAMES** | è‡ªåŠ¨åˆ†é…çš„å®¹å™¨åç§° |
     
     æ‰“å¼€æµè§ˆå™¨ï¼Œæˆ‘ä»¬è®¿é—®`localhost:8080`å’Œ`localhost:8081`å¯ä»¥çœ‹åˆ°å¯¹åº”çš„é¡¹ç›®
     
     
     
     **å‘½ä»¤è¡Œè§£æ**
     
     ```shell
     docker run \
     -it \
     -d \ 
     --name myvue2 \
     --privileged \
     -p 8081:8080 \
     -v /Users/eric/my-repository/my-app-vue2:/app/vue \
     node:10.16.2 \
     /bin/bash -c "cd /app/vue2 && node -v && npm install && npm run serve"
     ```
     
     
     
     | é”® |  å€¼  |
     | ----  |  ----  |
     | **docker run** | ä¸‹è½½é•œåƒ ->é€šè¿‡é•œåƒåˆ›å»ºå®¹å™¨ ->å¯åŠ¨è¿è¡Œå®¹å™¨                   |
     | **-it** | è¿™é‡Œæ˜¯ -iå’Œ -tçš„ç¼©å†™ã€‚<br />-iï¼š**å‘Šè¯‰ Docker å®¹å™¨ä¿æŒæ ‡å‡†è¾“å…¥æµå¯¹å®¹å™¨å¼€æ”¾,å³ä½¿å®¹å™¨æ²¡æœ‰ç»ˆç«¯è¿æ¥**å‘Šè¯‰ Docker ä¸ºå®¹å™¨åˆ†é…ä¸€ä¸ªè™šæ‹Ÿç»ˆç«¯ |
     | **-d** | åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨ID                                   |
     | **--name myvue2** | ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›                                         |
     | **--privileged** | è®©å®¹å™¨çš„ç”¨æˆ·åœ¨å®¹å™¨å†…èƒ½è·å–å®Œå…¨rootæƒé™ |
     | **-p 8081:8080** | æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£ |
     | **-v** | **å°†ä¸»æœºçš„my-app-vue2ç›®å½•(å‘½ä»¤è¡Œè¿™é‡Œåªèƒ½å†™ç»å¯¹è·¯å¾„å“ˆ)ä¸‹çš„å†…å®¹æŒ‚è½½åˆ°å®¹å™¨çš„ç›®å½•/app/vueå†…ï¼Œ** **å¦‚æœå®¹å™¨çš„æŒ‡å®šç›®å½•æœ‰æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼Œå°†è¢«æ¸…ç©º** **æŒ‚è½½åï¼Œå®¹å™¨ä¿®æ”¹ /app/vueç›®å½•çš„å†…å®¹ï¼Œä¹Ÿæ˜¯åœ¨ä¿®æ”¹ä¸»æœºç›®å½•/Users/eric/my-repository/my-app-vue2å†…å®¹** |
     | **node:10.16.2** |ä½œè€…ï¼šEric_long é“¾æ¥ï¼šhttps://juejin.cn/post/7050304120082661407 æ¥æºï¼šç¨€åœŸæ˜é‡‘ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚**è¿™é‡Œæ˜¯æŒ‡å®šnodejsï¼Œç‰ˆæœ¬ä¸º10.16.2çš„é•œåƒæ¥åˆ›å»ºå®¹å™¨**<br/>å¦‚æœä¸æŒ‡å®šç‰ˆæœ¬ï¼Œä¼šé»˜è®¤ä¸‹è½½å½“å‰é•œåƒçš„æœ€æ–°ç‰ˆæœ¬|
     | **/bin/bash -c 'xxx'** |**/bin/bash**ï¼šæ˜¯åœ¨è®©å®¹å™¨åˆ†é…çš„è™šæ‹Ÿç»ˆç«¯ä»¥ bash æ¨¡å¼æ‰§è¡Œå‘½ä»¤<br/>**-c ""cd /app/vue2 && node -v && npm install && npm run serve**ï¼šåªèƒ½æ‰§è¡Œä¸€æ¡ shell å‘½ä»¤ï¼Œéœ€è¦å¤šä¸ªå‘½ä»¤æŒ‰éœ€ç”¨&&ã€|
     



**docker runçš„è¿è¡Œç¤ºæ„å›¾**

![processon-run2](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/352f5d9252334d1ba1f57024020d752c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp)




 + 4. è°ƒè¯•

      **å¸¸ç”¨çš„è°ƒè¯•å‘½ä»¤ 1**

      ```bash
      # è¿è¡ŒåæŒ‰ctrl + c å¯é€€å‡º
      docker logs -f contianer_name/container_id
      å¤åˆ¶ä»£ç 
      ```

      å½“ç„¶å®¹å™¨å†…æ­£åœ¨è¿›è¡Œç¼–è¯‘æˆ–è€…å‘ç”Ÿé”™è¯¯ç”šè‡³é€€å‡ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ç”¨æ­¤å‘½ä»¤æŸ¥çœ‹ç»ˆç«¯è¾“å‡ºçš„ä¿¡æ¯

      ğŸŒ° ï¼šè¿è¡ŒæˆåŠŸåï¼ŒæŸ¥çœ‹myvue å®¹å™¨çš„npm run serve åœ¨ç»ˆç«¯ä¸Šçš„å®æ—¶è¾“å‡ºä¿¡æ¯

      ```bash
      #æŸ¥çœ‹docker containerçš„ç»ˆç«¯è¾“å‡ºä¿¡æ¯ 
      docker logs -f myvue2
      å¤åˆ¶ä»£ç 
      ```

      **å¸¸ç”¨çš„è°ƒè¯•å‘½ä»¤ 2**

      ```bash
      # æ‰“å°å‡ºå®¹å™¨çš„ç«¯å£æ˜ å°„ã€ç›®å½•æŒ‚è½½ã€ç½‘ç»œç­‰ç­‰
      docker inspect myvue2
      ```

      

## 5. å¸¸ç”¨æ“ä½œå‘½ä»¤

#### é•œåƒæ“ä½œå‘½ä»¤

```bash
# æœç´¢é•œåƒ
docker search [images_name:tag]

# ä¸‹è½½é•œåƒï¼ˆï¼šæŒ‡å®šç‰ˆæœ¬ï¼‰
docker pull [images_name:tag]

# æŸ¥çœ‹æœ¬åœ°ä¸‹è½½çš„é•œåƒ
docker images

# è‡ªå·±æ„å»ºé•œåƒ
# æ ¹æ®dockerfileçš„è·¯å¾„æˆ–è€…urlæ„å»ºé•œåƒ
 docker build [OPTIONS] PATH|URL|-

# æŸ¥çœ‹é•œåƒçš„æ„å»ºå†å²
docker history [images_name]

# åˆ é™¤é•œåƒ
# éœ€è¦å…ˆåˆ é™¤ä»¥æ­¤é•œåƒä¸ºåŸºç¡€çš„å®¹å™¨
 docker rmi [images_name]

```

#### å®¹å™¨æ“ä½œå‘½ä»¤

```bash
# æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨
# å¯ä»¥æŸ¥çœ‹å®¹å™¨IDã€åŸºç¡€é•œåƒã€å®¹å™¨åç§°ã€è¿è¡ŒçŠ¶æ€ã€ç«¯å£æ˜ å°„ç­‰
docker ps

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼šåŒ…æ‹¬åœæ­¢çš„
docker ps -a

# æŸ¥çœ‹å®¹å™¨çš„ä¿¡æ¯
# ä¾‹å¦‚ç«¯å£å·çš„æ˜ å°„ã€ç›®å½•æŒ‚è½½
docker inspect [images_name/images_id]

# å¯åŠ¨å’Œåœæ­¢å®¹å™¨
docker start/stop [container_name/container_id]

#  é‡å¯å®¹å™¨
#  ä½¿ç”¨åœºæ™¯å®ä¾‹ï¼š
#  åœ¨åŠ å…¥æ–°çš„npmåŒ…ä¾èµ–éœ€è¦é‡æ–°ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨é‡å¯è¿è¡Œç¼–è¯‘
#  nginxå®¹å™¨çš„é…ç½®æ›´æ–°åéœ€è¦é‡å¯ç”Ÿæ•ˆ
docker restart [container_name/container_id]

# è¿›å…¥å®¹å™¨
# ps:æœ‰äº›å®¹å™¨æ²¡æœ‰bash,éœ€è¦æ”¹æˆ/bin/shï¼Œä¾‹å¦‚mysqã€mongodbçš„
# é€€å‡ºäººå®¹å™¨è¾“å…¥exit å›è½¦é”®
docker exec -it [container_name/container_id] /bin/bash

# åˆ é™¤å®¹å™¨
# åœ¨å®¹å™¨åœæ­¢çš„çŠ¶æ€æ‰èƒ½åˆ 
docker rm [container_name/container_id]

# å®¹å™¨ä¸»æœºæ–‡ä»¶æ‹·
# å°†å®¹å™¨æ–‡ä»¶æ‹·è´åˆ°ä¸»æœº
docker cp [container_id/container_name] : [æ–‡ä»¶ç›®å½•] [ä¸»æœºç›®å½•]

# å°†ä¸»æœºçš„ç›®å½•æ‹·è´åˆ°å®¹å™¨
docker cp [ä¸»æœºç›®å½•] [container_id/container_name] : [æ–‡ä»¶ç›®å½•]

```



## 6 è¿›é˜¶

é€šå¸¸ç”¨Dockerfileæ¥æ„å»ºè‡ªå®šä¹‰é•œåƒ







#### å‚è€ƒï¼š[ç»™å‰ç«¯çš„docker 10åˆ†é’ŸçœŸ Â· å¿«é€Ÿå…¥é—¨æŒ‡å—][https://juejin.cn/post/7050304120082661407]